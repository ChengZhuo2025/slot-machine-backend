# 商城 Mock API 接口汇总

## 已实现的接口列表

### 1. 商品相关接口

#### 1.1 获取商品分类
- **接口**: `GET /api/mall/categories`
- **功能**: 获取商品分类列表

#### 1.2 获取商品列表
- **接口**: `GET /api/mall/products`
- **参数**: page, pageSize, keyword, categoryId, sortBy, sortOrder
- **功能**: 获取商品列表，支持分页、搜索、分类筛选、排序

#### 1.3 获取商品详情 ✅ (已完善)
- **接口**: `GET /api/mall/products/:id`
- **功能**: 获取商品详细信息
- **包含数据**:
  - 商品基本信息（名称、价格、库存、销量等）
  - 商品轮播图（8张）
  - 商品详情图（6张）
  - 多规格支持（颜色、尺寸，支持组合）
  - 商品参数（8项）
  - 配送信息
  - 售后服务
  - 商品标签
  - 收藏状态
  - 评价统计

#### 1.4 获取商品评价 ✅ (已完善)
- **接口**: `GET /api/mall/products/:id/reviews`
- **参数**: page, pageSize, rating, hasImages
- **功能**: 获取商品评价列表，支持按评分和图片筛选
- **包含数据**:
  - 用户信息（支持匿名）
  - 评分（1-5星）
  - 评价内容和图片（最多9张）
  - 商家回复
  - 追加评价
  - 点赞数

#### 1.5 获取热门商品
- **接口**: `GET /api/mall/popular`
- **功能**: 获取热门推荐商品

### 2. 购物车相关接口 ✅ (已完善)

#### 2.1 获取购物车列表
- **接口**: `GET /api/mall/cart`
- **功能**: 获取购物车商品列表和统计信息
- **包含数据**:
  - 商品列表（3-8个有效商品 + 可能的失效商品）
  - 商品详细信息（图片、价格、规格、数量等）
  - 选中状态
  - 库存状态
  - 失效原因
  - 统计信息（总数、选中数、总价、优惠等）

#### 2.2 添加商品到购物车
- **接口**: `POST /api/mall/cart`
- **功能**: 添加商品到购物车
- **返回**: 购物车商品信息和购物车总数

#### 2.3 更新购物车商品
- **接口**: `PUT /api/mall/cart/:id`
- **功能**: 更新购物车商品（数量、选中状态等）

#### 2.4 批量更新购物车商品
- **接口**: `PUT /api/mall/cart/batch`
- **功能**: 批量更新购物车商品（全选/取消全选）

#### 2.5 删除购物车商品
- **接口**: `DELETE /api/mall/cart/:id`
- **功能**: 删除单个购物车商品

#### 2.6 批量删除购物车商品
- **接口**: `DELETE /api/mall/cart/batch`
- **功能**: 批量删除购物车商品

#### 2.7 清空失效商品
- **接口**: `DELETE /api/mall/cart/invalid`
- **功能**: 清空所有失效商品

### 3. 订单相关接口 ✅ (已完善)

#### 3.1 创建订单
- **接口**: `POST /api/mall/orders`
- **功能**: 创建新订单
- **返回**: 订单详细信息（订单号、状态、支付截止时间等）

#### 3.2 获取订单列表
- **接口**: `GET /api/mall/orders`
- **参数**: page, pageSize, status
- **功能**: 获取订单列表，支持按状态筛选
- **状态**: pending(待支付), paid(待发货), shipped(待收货), completed(已完成), cancelled(已取消)

#### 3.3 获取订单详情
- **接口**: `GET /api/mall/orders/:id`
- **功能**: 获取订单详细信息
- **包含数据**:
  - 订单基本信息（订单号、状态、状态描述）
  - 商品列表
  - 收货地址
  - 物流信息（已发货状态）
  - 金额明细
  - 支付信息
  - 优惠券信息
  - 备注
  - 时间信息
  - 操作权限

#### 3.4 取消订单
- **接口**: `POST /api/mall/orders/:id/cancel`
- **功能**: 取消订单

#### 3.5 支付订单
- **接口**: `POST /api/mall/orders/:id/pay`
- **功能**: 支付订单
- **返回**: 支付成功信息和交易号

#### 3.6 确认收货
- **接口**: `POST /api/mall/orders/:id/confirm`
- **功能**: 确认收货

#### 3.7 申请退款
- **接口**: `POST /api/mall/orders/:id/refund`
- **功能**: 申请退款
- **返回**: 退款单号和退款信息

#### 3.8 删除订单
- **接口**: `DELETE /api/mall/orders/:id`
- **功能**: 删除订单

### 4. 搜索相关接口 ✅ (已完善)

#### 4.1 商品搜索
- **接口**: `GET /api/mall/search`
- **参数**: keyword, page, pageSize, sortBy, sortOrder, categoryId, minPrice, maxPrice
- **功能**: 搜索商品，支持关键词、分类、价格区间筛选和排序

#### 4.2 搜索建议
- **接口**: `GET /api/mall/search/suggest`
- **参数**: keyword
- **功能**: 获取搜索建议列表

#### 4.3 热门搜索
- **接口**: `GET /api/mall/search/hot`
- **功能**: 获取热门搜索关键词

#### 4.4 搜索历史
- **接口**: `GET /api/mall/search/history`
- **功能**: 获取用户搜索历史

#### 4.5 添加搜索历史
- **接口**: `POST /api/mall/search/history`
- **功能**: 添加搜索历史记录

#### 4.6 清空搜索历史
- **接口**: `DELETE /api/mall/search/history`
- **功能**: 清空所有搜索历史

### 5. 评价相关接口 ✅ (已完善)

#### 5.1 提交商品评价
- **接口**: `POST /api/mall/reviews`
- **功能**: 提交商品评价
- **支持**: 评分、文字、图片、匿名评价

#### 5.2 追加评价
- **接口**: `POST /api/mall/reviews/:id/append`
- **功能**: 追加评价内容

#### 5.3 评价点赞
- **接口**: `POST /api/mall/reviews/:id/helpful`
- **功能**: 给评价点赞

### 6. 优惠券相关接口 ✅ (已完善)

#### 6.1 获取优惠券列表
- **接口**: `GET /api/mall/coupons`
- **参数**: status (available, used, expired)
- **功能**: 获取优惠券列表，支持按状态筛选
- **包含数据**:
  - 优惠券类型（满减券、折扣券）
  - 优惠金额/折扣
  - 使用条件
  - 有效期
  - 使用状态
  - 适用范围

#### 6.2 领取优惠券
- **接口**: `POST /api/mall/coupons/:id/receive`
- **功能**: 领取优惠券

#### 6.3 获取可用优惠券
- **接口**: `GET /api/mall/coupons/available`
- **参数**: amount (订单金额)
- **功能**: 获取当前订单可用的优惠券列表

## 接口特性

### 数据完整性
- ✅ 所有接口返回完整的业务数据
- ✅ 支持分页（page, pageSize）
- ✅ 支持筛选和排序
- ✅ 包含必要的统计信息

### 业务逻辑
- ✅ 购物车支持有效/失效商品区分
- ✅ 订单支持多种状态流转
- ✅ 物流信息仅在已发货状态显示
- ✅ 评价支持匿名、图片、追加、商家回复
- ✅ 优惠券支持多种类型和使用条件

### 数据真实性
- ✅ 使用 Mock.js 生成随机但合理的数据
- ✅ 模拟网络延迟（200-1000ms）
- ✅ 数据关联性合理（如价格、库存、评分等）

## 对应需求覆盖

### 需求 1.1, 1.2, 1.9, 8.1 - 商品详情
✅ 完善了商品详情接口，包含完整的商品信息、规格、参数、评价统计

### 需求 2.1, 2.2, 2.4, 2.7, 8.2, 8.3 - 购物车
✅ 实现了完整的购物车 CRUD 接口，支持批量操作和失效商品处理

### 需求 3.9, 4.1, 4.2, 4.8, 4.9, 8.4, 8.5, 8.6 - 订单
✅ 实现了订单创建、查询、操作接口，包含完整的物流信息

### 需求 5.1, 5.2, 5.8, 6.6, 8.7, 8.8 - 搜索和评价
✅ 实现了商品搜索、搜索建议、评价提交和查询接口

## 总结

所有 Mock 接口已完整实现，覆盖了商城模块的所有核心功能：
- ✅ 商品浏览和详情
- ✅ 购物车管理
- ✅ 订单流程
- ✅ 商品搜索
- ✅ 商品评价
- ✅ 优惠券系统

接口数据结构完整，业务逻辑合理，可以支持前端页面的完整开发和测试。
